import{Q as E,a as U,b as T,c as B,d as H,e as J,f as b,g as q}from"./QDialog.876d3bb7.js";import{b as y}from"./QSeparator.b874be8f.js";import{u as D}from"./UserStore.0e76a966.js";import{api as p}from"./axios.817f73cc.js";import{Q as w}from"./QInput.61387de3.js";import{f as h,Q as R}from"./QBtn.f20efc65.js";import{_ as P,E as l,I as u,L as a,H as o,G as m,P as c,J as f,R as M,S as j,K as _,M as g,N as C,O as S,a6 as z,F as k,q as N}from"./index.21c77581.js";import{Q as Y}from"./QPagination.04a12fbb.js";import{R as G}from"./RestaurantList.a39cdf11.js";import{Q as F}from"./QImg.146a52d2.js";import{C as A}from"./ClosePopup.e4beb4fb.js";import"./focus-manager.33224ae2.js";import"./use-timeout.9ede0bc3.js";import"./use-panel.348b8b63.js";import"./touch.70a9dd44.js";import"./selection.5cd546be.js";import"./use-dark.6a233e5d.js";import"./format.573576cb.js";const K={name:"ProfileEditProfile",props:["editProfileErrorMessage","loadingParent"],setup(){return{userStore:D()}},data(){return{oldProfileImage:"",newProfileImage:"",email:"jan.merhar@gmail.com",oldName:"Jan",newName:"",oldSurname:"Merhar",newSurname:"",newPassword:"",isNewPwd:!0,newRepeatPassword:"",isNewRepeatPwd:!0,currentPassword:"",isCurrPwd:!0,uploadedFile:null,errorMessage:"",loading:!1}},watch:{editProfileErrorMessage(t){this.errorMessage=t},loadingParent(t){this.loading=t}},mounted(){this.userStore.token===null&&this.$router.push("/"),this.oldProfileImage=this.userStore.data.profile_image_path,this.email=this.userStore.data.email,this.oldName=this.userStore.data.name,this.oldSurname=this.userStore.data.surname,this.newProfileImage=this.oldProfileImage,this.newName=this.oldName,this.newSurname=this.oldSurname},methods:{previewFiles(t){const s=t.target.files[0];if(s!==void 0&&s.type.includes("image")){const i=document.getElementById("profilePicture"),v=new FileReader;v.onload=e=>{i.src=e.target.result,this.uploadedFile=s},v.readAsDataURL(s)}},checkChanges(){if(this.currentPassword==="")this.errorMessage="Potrebno je vpisati trenutno geslo!";else if(this.newPassword!==this.newRepeatPassword)this.errorMessage="Nova gesla se ne ujemata!";else if(this.newName===this.oldName&&this.newSurname===this.oldSurname&&!this.changeInPassword&&this.uploadedFile===null)this.errorMessage="Ni nobene spremembe v podatkih!";else{const t={currentPassword:this.currentPassword,name:this.newName,surname:this.newSurname,password:this.newPassword,image:this.uploadedFile};this.$emit("changeProfileData",t)}},async changeInPassword(){try{this.loading=!0,await p.get("/sanctum/csrf-cookie");const t=await p.post("/checkChangeInPassword",{password:this.newPassword,password_confirmation:this.newRepeatPassword});return this.errorMessage="",this.loading=!1,t.data.isChanged}catch(t){return this.errorMessage=t.response.data.message,!1}}}},Q=t=>(M("data-v-d1618a9a"),t=t(),j(),t),W={style:{"text-align":"center"}},X=Q(()=>a("div",{class:"text-h4 q-mb-xl"}," Uredi profil ",-1)),Z={class:"form-container q-py-lg q-px-xl q-mx-auto",style:{"max-width":"700px"}},$=Q(()=>a("div",{style:{"text-align":"center"},class:"text-h6 q-mb-md q-mt-xl"}," Profilna slika ",-1)),ee={style:{display:"inline-block",position:"relative"}},te=["src"],se={key:0,class:"text-red-8 text-h6 q-mt-lg"};function ae(t,s,i,v,e,d){return l(),u("div",W,[X,a("div",Z,[$,a("div",ee,[a("input",{id:"poster-file",class:"aspect-ratio profile-picture-picker rounded-circle",name:"movie_poster",type:"file",accept:"image/*",onChange:s[0]||(s[0]=(...n)=>d.previewFiles&&d.previewFiles(...n))},null,32),a("img",{id:"profilePicture",src:e.oldProfileImage,class:"aspect-ratio rounded-circle profile-picture w-100"},null,8,te)]),o(w,{modelValue:e.email,"onUpdate:modelValue":s[1]||(s[1]=n=>e.email=n),label:"Email",class:"q-py-lg",disable:""},null,8,["modelValue"]),o(w,{modelValue:e.newName,"onUpdate:modelValue":s[2]||(s[2]=n=>e.newName=n),label:"Ime",class:"q-py-lg",disable:e.loading},null,8,["modelValue","disable"]),o(w,{modelValue:e.newSurname,"onUpdate:modelValue":s[3]||(s[3]=n=>e.newSurname=n),label:"Priimek",class:"q-py-lg",disable:e.loading},null,8,["modelValue","disable"]),o(w,{modelValue:e.newPassword,"onUpdate:modelValue":s[5]||(s[5]=n=>e.newPassword=n),label:"Novo geslo",type:e.isNewPwd?"password":"text",class:"q-py-lg",disable:e.loading},{append:m(()=>[o(h,{name:e.isNewPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>e.isNewPwd=!e.isNewPwd)},null,8,["name"])]),_:1},8,["modelValue","type","disable"]),o(w,{modelValue:e.newRepeatPassword,"onUpdate:modelValue":s[7]||(s[7]=n=>e.newRepeatPassword=n),label:"Ponovi novo geslo",type:e.isNewRepeatPwd?"password":"text",class:"q-py-lg",disable:e.loading},{append:m(()=>[o(h,{name:e.isNewRepeatPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>e.isNewRepeatPwd=!e.isNewRepeatPwd)},null,8,["name"])]),_:1},8,["modelValue","type","disable"]),o(w,{modelValue:e.currentPassword,"onUpdate:modelValue":s[9]||(s[9]=n=>e.currentPassword=n),label:"Trenutno geslo",type:e.isCurrPwd?"password":"text",class:"q-py-lg",disable:e.loading},{append:m(()=>[o(h,{name:e.isCurrPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>e.isCurrPwd=!e.isCurrPwd)},null,8,["name"])]),_:1},8,["modelValue","type","disable"]),o(R,{label:"Shrani",color:"white",flat:"","no-caps":"",style:{"font-size":"1rem"},class:"bg-positive border-rad",disable:e.loading,onClick:d.checkChanges},null,8,["disable","onClick"]),e.errorMessage.length>0?(l(),u("p",se,c(e.errorMessage),1)):f("",!0)])])}var oe=P(K,[["render",ae],["__scopeId","data-v-d1618a9a"]]);const ie={name:"ProfileFavourited",components:{RestaurantList:G},props:["restaurants","numResults","loading"],data(){return{currentPage:1}},computed:{numPages(){return parseInt(Math.ceil(this.numResults/9))}},methods:{onChangePage(){this.$emit("loadRestaurants",this.currentPage)}}},re=a("div",{style:{"text-align":"center"},class:"text-h4 q-mb-xl"}," Priljubljene restavracije ",-1),ne={class:"row wrap justify-center"},le={class:"col-12 col-md-11 col-lg-8"},ce={class:"col-8 q-mb-xl flex flex-center"};function de(t,s,i,v,e,d){const n=_("restaurant-list");return l(),u("div",null,[re,a("div",ne,[a("div",le,[o(n,{restaurants:i.restaurants},null,8,["restaurants"])]),a("div",ce,[o(Y,{modelValue:e.currentPage,"onUpdate:modelValue":s[0]||(s[0]=r=>e.currentPage=r),max:d.numPages,"max-pages":6,"direction-links":"",color:"positive",disable:i.loading,onClick:d.onChangePage},null,8,["modelValue","max","disable","onClick"])])])])}var ue=P(ie,[["render",de]]);const me={name:"PastReservationCard",props:["pastReservation"],data(){return{showMoreInfo:!1,totalPrice:0,time:"",date:""}},mounted(){const t=new Date(this.pastReservation.date_and_time_of_reservation.split(" "));this.date=t.getDate()+". "+(t.getMonth()+1)+". "+t.getFullYear(),this.time=t.getHours()+":"+t.getMinutes(),this.pastReservation.pickedMenus.forEach(s=>{this.totalPrice+=s.quantity*s.price})}},I=t=>(M("data-v-3a8a182a"),t=t(),j(),t),ve={class:"row wrap"},pe={class:"col-12 col-sm-4 self-baseline"},_e={class:"col-12 col-sm-8 row wrap q-px-md self-stretch"},he={class:"col-4 text-positive text-h5",style:{"text-align":"right"}},fe={class:"col-12 text-h5 custom-font-color"},ge={class:"col-12 text-h5 custom-font-color"},Pe={class:"col-4 text-h5 custom-font-color"},we={class:"col-12 col-sm-8 text-h6 text-right custom-font-color"},Re={key:0,class:"col-12 row wrap"},ye=I(()=>a("div",{class:"text-h5 q-my-lg col-12",style:{"text-align":"center"}}," Va\u0161e naro\u010Dilo ",-1)),xe={class:"text-h6 col-10 custom-font-color q-mx-auto"},be={class:"row no-wrap"},qe={class:"col-8"},ke={class:"col-4",style:{"text-align":"right"}},Me={class:"col-10 q-mx-auto"},je={class:"col-10 q-mx-auto row no-wrap text-h6 custom-font-color"},Ce=I(()=>a("span",{class:"col-8"},"Skupaj",-1)),Se={class:"col-4",style:{"text-align":"right"}},Ie={key:0,class:"col-10 q-mx-auto custom-font-color q-mt-md text-h6"},Ve=I(()=>a("span",{class:"text-h5"},"(",-1)),Ne=I(()=>a("span",{class:"text-h5"},")",-1)),Ae={class:"col-10 q-mx-auto q-mt-xl text-right"},De={class:"col-12",style:{"margin-left":"-1rem"}};function ze(t,s,i,v,e,d){const n=_("router-link");return l(),u("div",ve,[a("div",pe,[o(F,{src:i.pastReservation.image,alt:"Ni slike",fit:""},null,8,["src"])]),a("div",_e,[o(n,{to:"/restaurant/"+i.pastReservation.id_restaurant,class:"col-8 text-h5 q-mb-md custom-link"},{default:m(()=>[a("div",null,c(i.pastReservation.name),1)]),_:1},8,["to"]),a("div",he,c((Math.round(e.totalPrice*100)/100).toFixed(2))+" \u20AC ",1),a("div",fe,[g(c(i.pastReservation.number_of_personel)+" ",1),o(h,{name:"person",color:"positive"})]),a("div",ge,[g(c(e.date)+" ",1),o(h,{name:"event",color:"positive"})]),a("div",Pe,[g(c(e.time)+" ",1),o(h,{name:"schedule",color:"positive"})]),a("div",we,[e.showMoreInfo?f("",!0):(l(),u("span",{key:0,class:"info-button",onClick:s[0]||(s[0]=r=>e.showMoreInfo=!0)},"Ve\u010D informacij o naro\u010Dilu"))])]),e.showMoreInfo?(l(),u("div",Re,[ye,a("div",xe,[(l(!0),u(C,null,S(i.pastReservation.pickedMenus,r=>(l(),u("div",{key:r.id_menu},[a("div",be,[a("span",qe,c(r.name)+" "+c(r.quantity)+"x",1),a("span",ke,c((Math.round(r.price*r.quantity*100)/100).toFixed(2))+" \u20AC",1)])]))),128))]),a("div",Me,[o(y,{color:"black",width:"100%",class:"q-my-md"})]),a("div",je,[Ce,a("span",Se,c((Math.round(e.totalPrice*100)/100).toFixed(2))+" \u20AC",1)]),i.pastReservation.note!==null?(l(),u("div",Ie,[Ve,g("Opomba: "+c(i.pastReservation.note),1),Ne])):f("",!0),a("div",Ae,[a("span",{class:"info-button text-h6 custom-font-color",onClick:s[1]||(s[1]=r=>e.showMoreInfo=!1)}," Manj informacij o naro\u010Dilu ")])])):f("",!0),a("div",De,[o(y,{color:"grey",width:"100%",inset:"",class:z(e.showMoreInfo?"q-mt-md q-mb-xl":"q-mt-xl q-mb-xl")},null,8,["class"])])])}var Fe=P(me,[["render",ze],["__scopeId","data-v-3a8a182a"]]);const Qe={name:"ProfilePastReservations",components:{PastReservationCard:Fe},props:["pastReservations","numPastReservations","loading"],methods:{loadMorePastReservations(t){this.$emit("loadMorePastReservations",t)}}},Le={class:"row wrap"},Oe=a("div",{style:{"text-align":"center"},class:"text-h4 q-mb-xl col-12"}," Pretekle Rezervacije ",-1),Ee={class:"col-12 offset-md-2 col-md-8 offset-lg-3 col-lg-6"},Ue={style:{"text-align":"center"},class:"col-12 q-my-xl"};function Te(t,s,i,v,e,d){const n=_("past-reservation-card");return l(),u("div",Le,[Oe,a("div",Ee,[(l(!0),u(C,null,S(i.pastReservations,r=>(l(),k(n,{key:r.id_reservation,"past-reservation":r,class:"col-6"},null,8,["past-reservation"]))),128))]),a("div",Ue,[i.pastReservations.length>3&&i.numPastReservations>i.pastReservations.length?(l(),k(R,{key:0,label:"Nalo\u017Ei ve\u010D",color:"white",flat:"","no-caps":"",style:{"font-size":"1.3rem"},class:"bg-positive border-rad q-px-xl q-py-none",disable:i.loading,onClick:s[0]||(s[0]=r=>d.loadMorePastReservations(i.pastReservations.length))},null,8,["disable"])):f("",!0)])])}var Be=P(Qe,[["render",Te]]);const He={name:"ActiveReservationCard",props:["activeReservation"],data(){return{confirmDelete:!1,showMoreInfo:!1,totalPrice:0,time:"",date:""}},mounted(){const t=new Date(this.activeReservation.date_and_time_of_reservation.split(" "));this.date=t.getDate()+". "+(t.getMonth()+1)+". "+t.getFullYear(),this.time=t.getHours()+":"+t.getMinutes(),this.activeReservation.pickedMenus.forEach(s=>{this.totalPrice+=s.quantity*s.price})},methods:{deleteReservation(){this.$emit("deleteReservation",this.activeReservation.id_reservation)}}},x=t=>(M("data-v-1f5f62f9"),t=t(),j(),t),Je={class:"row wrap"},Ye={class:"col-12 col-sm-4 self-baseline"},Ge={class:"col-12 col-sm-8 row wrap q-px-md self-stretch"},Ke={class:"col-4 text-positive text-h5",style:{"text-align":"right"}},We={class:"col-12 text-h5 custom-font-color"},Xe={class:"col-12 text-h5 custom-font-color"},Ze={class:"col-4 text-h5 custom-font-color"},$e={class:"col-12 col-sm-8 text-h6 text-right custom-font-color"},et={key:0,class:"col-12 row wrap"},tt=x(()=>a("div",{class:"text-h5 q-my-lg col-12",style:{"text-align":"center"}}," Va\u0161e naro\u010Dilo ",-1)),st={class:"text-h6 col-10 custom-font-color q-mx-auto"},at={class:"row no-wrap"},ot={class:"col-8"},it={class:"col-4",style:{"text-align":"right"}},rt={class:"col-10 q-mx-auto"},nt={class:"col-10 q-mx-auto row no-wrap text-h6 custom-font-color"},lt=x(()=>a("span",{class:"col-8"},"Skupaj",-1)),ct={class:"col-4",style:{"text-align":"right"}},dt={key:0,class:"col-10 q-mx-auto custom-font-color q-mt-md text-h6"},ut=x(()=>a("span",{class:"text-h5"},"(",-1)),mt=x(()=>a("span",{class:"text-h5"},")",-1)),vt={class:"col-10 q-mx-auto q-mt-lg text-right"},pt={class:"col-10 q-mx-auto q-mt-xl text-right",style:{"text-align":"right"}},_t={class:"col-12",style:{"margin-left":"-1rem"}},ht=x(()=>a("span",{class:"q-ml-sm"},"Ali ste prepri\u010Dani, da \u017Eelite preklicati rezervacijo?",-1));function ft(t,s,i,v,e,d){const n=_("router-link");return l(),u("div",Je,[a("div",Ye,[o(F,{src:i.activeReservation.image,alt:"Ni slike",fit:""},null,8,["src"])]),a("div",Ge,[o(n,{to:"/restaurant/"+i.activeReservation.id_restaurant,class:"col-8 text-h5 q-mb-md custom-link"},{default:m(()=>[a("div",null,c(i.activeReservation.name),1)]),_:1},8,["to"]),a("div",Ke,c((Math.round(e.totalPrice*100)/100).toFixed(2))+" \u20AC ",1),a("div",We,[g(c(i.activeReservation.number_of_personel)+" ",1),o(h,{name:"person",color:"positive"})]),a("div",Xe,[g(c(e.date)+" ",1),o(h,{name:"event",color:"positive"})]),a("div",Ze,[g(c(e.time)+" ",1),o(h,{name:"schedule",color:"positive"})]),a("div",$e,[e.showMoreInfo?f("",!0):(l(),u("span",{key:0,class:"info-button",onClick:s[0]||(s[0]=r=>e.showMoreInfo=!0)},"Ve\u010D informacij o naro\u010Dilu"))])]),e.showMoreInfo?(l(),u("div",et,[tt,a("div",st,[(l(!0),u(C,null,S(i.activeReservation.pickedMenus,r=>(l(),u("div",{key:r.id_menu},[a("div",at,[a("span",ot,c(r.name)+" "+c(r.quantity)+"x",1),a("span",it,c((Math.round(r.price*r.quantity*100)/100).toFixed(2))+" \u20AC",1)])]))),128))]),a("div",rt,[o(y,{color:"black",width:"100%",class:"q-my-md"})]),a("div",nt,[lt,a("span",ct,c((Math.round(e.totalPrice*100)/100).toFixed(2))+" \u20AC",1)]),i.activeReservation.note!==null?(l(),u("div",dt,[ut,g("Opomba: "+c(i.activeReservation.note),1),mt])):f("",!0),a("div",vt,[o(R,{label:"Prekli\u010Di rezervacijo",color:"white",flat:"","no-caps":"",size:"1.15rem",class:"bg-red-8 border-rad button-float",onClick:s[1]||(s[1]=r=>e.confirmDelete=!0)})]),a("div",pt,[a("span",{class:"info-button text-h6 custom-font-color",onClick:s[2]||(s[2]=r=>e.showMoreInfo=!1)}," Manj informacij o naro\u010Dilu ")])])):f("",!0),a("div",_t,[o(y,{color:"grey",width:"100%",inset:"",class:z(e.showMoreInfo?"q-mt-md q-mb-xl":"q-mt-xl q-mb-xl")},null,8,["class"])]),o(B,{modelValue:e.confirmDelete,"onUpdate:modelValue":s[4]||(s[4]=r=>e.confirmDelete=r),persistent:""},{default:m(()=>[o(E,null,{default:m(()=>[o(U,{class:"row items-center text-h5 q-pa-xl"},{default:m(()=>[ht]),_:1}),o(T,{align:"right"},{default:m(()=>[N(o(R,{flat:"",label:"Ne",color:"primary","no-caps":"",style:{"font-size":"1rem"},class:"border-rad text-grey-7",onClick:s[3]||(s[3]=r=>e.confirmDelete=!1)},null,512),[[A]]),N(o(R,{flat:"",label:"Da",color:"white","no-caps":"",style:{"font-size":"1rem"},class:"bg-red-8 border-rad q-ma-sm",onClick:d.deleteReservation},null,8,["onClick"]),[[A]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var gt=P(He,[["render",ft],["__scopeId","data-v-1f5f62f9"]]);const Pt={name:"ProfileActiveReservations",components:{ActiveReservationCard:gt},props:["activeReservations","numActiveReservations","loading"],methods:{deleteReservation(t){this.$emit("deleteReservation",t)},loadMoreActiveReservations(t){this.$emit("loadMoreActiveReservations",t)}}},wt={class:"row wrap"},Rt=a("div",{style:{"text-align":"center"},class:"text-h4 q-mb-xl col-12"}," Aktivne Rezervacije ",-1),yt={class:"col-12 offset-md-2 col-md-8 offset-lg-3 col-lg-6"},xt={style:{"text-align":"center"},class:"col-12 q-my-xl"};function bt(t,s,i,v,e,d){const n=_("active-reservation-card");return l(),u("div",wt,[Rt,a("div",yt,[(l(!0),u(C,null,S(i.activeReservations,r=>(l(),k(n,{key:r.id_reservation,"active-reservation":r,class:"col-6",onDeleteReservation:d.deleteReservation},null,8,["active-reservation","onDeleteReservation"]))),128))]),a("div",xt,[i.activeReservations.length>3&&i.numActiveReservations>i.activeReservations.length?(l(),k(R,{key:0,label:"Nalo\u017Ei ve\u010D",color:"white",flat:"","no-caps":"",style:{"font-size":"1.3rem"},class:"bg-positive border-rad q-px-xl q-py-none",disable:i.loading,onClick:s[0]||(s[0]=r=>d.loadMoreActiveReservations(i.activeReservations.length))},null,8,["disable"])):f("",!0)])])}var qt=P(Pt,[["render",bt]]);const kt={name:"ProfilePage",components:{ProfileEditProfile:oe,ProfileFavourited:ue,ProfilePastReservations:Be,ProfileActiveReservations:qt},setup(){return{userStore:D()}},data(){return{tab:"edit_profile",restaurants:[],numPastReservations:0,pastReservations:[{id_reservation:0,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",price:23.2,pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:1,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:2,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:3,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]}],currentPastReservationOffset:4,numActiveReservations:0,activeReservations:[{id_reservation:0,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",price:23.2,pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:1,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:2,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]},{id_reservation:3,image:"../pages/restaurant.jpg",name:"Restavracija Pod Lipco",numPersons:6,date:"22.2.2022",time:"10:30",pickedMenus:[{id_menu:0,name:"Sirov burek",price:3.6,quantity:2},{id_menu:1,name:"Dunajski zrezek",price:6.2,quantity:4},{id_menu:2,name:"Pica Margarita",price:4,quantity:1}]}],currentActiveReservationOffset:4,numResults:0,currentPage:1,loading:!1,editProfileErrorMessage:""}},mounted(){this.userStore.token===null&&this.$router.push("/"),this.loadProfile()},methods:{async loadProfile(){try{this.loading=!0,await p.get("/sanctum/csrf-cookie");const t=await p.get("/profile",{params:{page:this.currentPage,reservationOffset:4}});this.restaurants=t.data.restaurants.data,this.numResults=t.data.num_of_restaurants,this.pastReservations=t.data.pastReservations,this.activeReservations=t.data.activeReservations,this.numPastReservations=t.data.numOfPastReservations,this.numActiveReservations=t.data.numOfActiveReservations,this.loading=!1}catch{this.loading=!1}},async loadRestaurants(t){this.currentPage=t,this.loadProfile()},async changeProfileData(t){try{this.loading=!0,await p.get("/sanctum/csrf-cookie");let s=await p.put("/editProfile",{current_password:t.currentPassword,name:t.name,surname:t.surname,password:t.password,image:t.image});if(this.userStore.data=s.data.userData,this.editProfileErrorMessage="",t.image!==null){const i=new FormData;i.append("file",t.image),s=await p.post("/editProfileImage",i,{headers:{"Content-Type":"multipart/form-data"}}),this.userStore.data.profile_image_path=s.data.imageName}this.loading=!1}catch(s){this.editProfileErrorMessage=s.response.data.message,this.loading=!1}},async deleteReservation(t){try{this.loading=!0;const s=await p.delete("/deleteReservation",{params:{id_reservation:t,reservationOffset:this.currentActiveReservationOffset}});this.activeReservations=s.data.activeReservations,this.numActiveReservations=s.data.numOfActiveReservations,this.loading=!1}catch{this.loading=!1}},async loadMoreActiveReservations(t){try{this.loading=!0,this.currentActiveReservationOffset=t+4;const s=await p.get("/moreActiveReservations",{params:{reservationOffset:this.currentActiveReservationOffset}});this.activeReservations=s.data.activeReservations,this.loading=!1}catch{this.loading=!1}},async loadMorePastReservations(t){try{this.loading=!0,this.currentPastReservationOffset=t+4;const s=await p.post("/morePastReservations",{params:{reservationOffset:this.currentPastReservationOffset}});this.pastReservations=s.data.PastReservations,this.loading=!1}catch{this.loading=!1}}}},Mt=t=>(M("data-v-3085d6be"),t=t(),j(),t),jt=Mt(()=>a("p",{class:"page-title q-mb-xl"}," Domov / Moj Profil ",-1)),Ct={style:{"text-align":"center"}},St=["src"],It={class:"q-mt-sm text-h5"},Vt={class:"q-mt-xl"};function Nt(t,s,i,v,e,d){const n=_("profile-edit-profile"),r=_("profile-favourited"),L=_("profile-past-reservations"),O=_("profile-active-reservations");return l(),u("div",null,[jt,a("div",Ct,[a("img",{src:v.userStore.data.profile_image_path,class:"profile-picture"},null,8,St),a("div",It,c(v.userStore.data.name)+" "+c(v.userStore.data.surname),1)]),a("div",Vt,[o(H,{modelValue:e.tab,"onUpdate:modelValue":s[0]||(s[0]=V=>e.tab=V),"inline-label":"","outside-arrows":"","mobile-arrows":"",align:"justify"},{default:m(()=>[o(b,{name:"edit_profile",label:"Uredi profil","no-caps":""}),o(b,{name:"favourited",label:"Priljubljene ("+e.numResults+")","no-caps":""},null,8,["label"]),o(b,{name:"previus_reservations",label:"Pretekle rezervacije ("+e.numPastReservations+")","no-caps":""},null,8,["label"]),o(b,{name:"active_reservations",label:"Aktivne rezervacije ("+e.numActiveReservations+")","no-caps":""},null,8,["label"])]),_:1},8,["modelValue"]),o(y,{color:"grey",inset:"",class:"q-mx-lg"}),o(J,{modelValue:e.tab,"onUpdate:modelValue":s[1]||(s[1]=V=>e.tab=V),animated:"",class:"q-my-xl"},{default:m(()=>[o(q,{name:"edit_profile"},{default:m(()=>[o(n,{"edit-profile-error-message":e.editProfileErrorMessage,"loading-parent":e.loading,onChangeProfileData:d.changeProfileData},null,8,["edit-profile-error-message","loading-parent","onChangeProfileData"])]),_:1}),o(q,{name:"favourited"},{default:m(()=>[o(r,{restaurants:e.restaurants,"num-results":e.numResults,loading:e.loading,onLoadRestaurants:d.loadRestaurants},null,8,["restaurants","num-results","loading","onLoadRestaurants"])]),_:1}),o(q,{name:"previus_reservations"},{default:m(()=>[o(L,{"past-reservations":e.pastReservations,"num-past-reservations":e.numPastReservations,loading:e.loading,onLoadMorePastReservations:d.loadMorePastReservations},null,8,["past-reservations","num-past-reservations","loading","onLoadMorePastReservations"])]),_:1}),o(q,{name:"active_reservations"},{default:m(()=>[o(O,{"active-reservations":e.activeReservations,"num-active-reservations":e.numActiveReservations,loading:e.loading,onDeleteReservation:d.deleteReservation,onLoadMoreActiveReservations:d.loadMoreActiveReservations},null,8,["active-reservations","num-active-reservations","loading","onDeleteReservation","onLoadMoreActiveReservations"])]),_:1})]),_:1},8,["modelValue"])])])}var Zt=P(kt,[["render",Nt],["__scopeId","data-v-3085d6be"]]);export{Zt as default};
