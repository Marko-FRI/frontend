import{ad as g,r as P,D,a9 as q,t as F,ae as L,j as b,$ as T,m as K,k as N,x as I,c as k,W as E}from"./index.2a4f541f.js";import{b as $,c as Q}from"./focus-manager.33224ae2.js";import{y as c,j as S,c as G}from"./QBtn.6698489e.js";let M=1,O=document.body;function j(e,t){const n=document.createElement("div");if(n.id=t!==void 0?`q-portal--${t}--${M++}`:e,g.globalNodes!==void 0){const o=g.globalNodes.class;o!==void 0&&(n.className=o)}return O.appendChild(n),n}function A(e){e.remove()}const d=[];function U(e){return d.find(t=>t.contentEl!==null&&t.contentEl.contains(e))}function W(e,t){do{if(e.$options.name==="QMenu"){if(e.hide(t),e.$props.separateClosePopup===!0)return c(e)}else if(e.__qPortal===!0){const n=c(e);return n!==void 0&&n.$options.name==="QPopupProxy"?(e.hide(t),n):e}e=c(e)}while(e!=null)}function B(e,t,n){for(;n!==0&&e!==void 0&&e!==null;){if(e.__qPortal===!0){if(n--,e.$options.name==="QMenu"){e=W(e,t);continue}e.hide(t)}e=c(e)}}function H(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Y(e,t,n,o){const i=P(!1),u=P(!1);let r=null;const f={},h=o==="dialog"&&H(e);function y(p){if(p===!0){$(f),u.value=!0;return}u.value=!1,i.value===!1&&(h===!1&&r===null&&(r=j(!1,o)),i.value=!0,d.push(e.proxy),Q(f))}function v(p){if(u.value=!1,p!==!0)return;$(f),i.value=!1;const m=d.indexOf(e.proxy);m!==-1&&d.splice(m,1),r!==null&&(A(r),r=null)}return D(()=>{v(!0)}),e.proxy.__qPortal=!0,q(e.proxy,"contentEl",()=>t.value),{showPortal:y,hidePortal:v,portalIsActive:i,portalIsAccessible:u,renderPortal:()=>h===!0?n():i.value===!0?[F(L,{to:r},n())]:void 0}}const Z={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function ee(e,t=()=>{},n=()=>{}){return{transitionProps:b(()=>{const o=`q-transition--${e.transitionShow||t()}`,i=`q-transition--${e.transitionHide||n()}`;return{appear:!0,enterFromClass:`${o}-enter-from`,enterActiveClass:`${o}-enter-active`,enterToClass:`${o}-enter-to`,leaveFromClass:`${i}-leave-from`,leaveActiveClass:`${i}-leave-active`,leaveToClass:`${i}-leave-to`}}),transitionStyle:b(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}function te(){let e;const t=I();function n(){e=void 0}return T(n),K(n),{removeTick:n,registerTick(o){e=o,N(()=>{e===o&&(S(t)===!1&&e(),e=void 0)})}}}const s=[];let l;function x(e){l=e.keyCode===27}function z(){l===!0&&(l=!1)}function J(e){l===!0&&(l=!1,E(e,27)===!0&&s[s.length-1](e))}function _(e){window[e]("keydown",x),window[e]("blur",z),window[e]("keyup",J),l=!1}function ne(e){k.is.desktop===!0&&(s.push(e),s.length===1&&_("addEventListener"))}function oe(e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.length===0&&_("removeEventListener"))}const a=[];function C(e){a[a.length-1](e)}function ie(e){k.is.desktop===!0&&(a.push(e),a.length===1&&document.body.addEventListener("focusin",C))}function se(e){const t=a.indexOf(e);t>-1&&(a.splice(t,1),a.length===0&&document.body.removeEventListener("focusin",C))}function w(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var ae=G({name:"close-popup",beforeMount(e,{value:t}){const n={depth:w(t),handler(o){n.depth!==0&&setTimeout(()=>{const i=U(e);i!==void 0&&B(i,o,n.depth)})},handlerKey(o){E(o,13)===!0&&n.handler(o)}};e.__qclosepopup=n,e.addEventListener("click",n.handler),e.addEventListener("keyup",n.handlerKey)},updated(e,{value:t,oldValue:n}){t!==n&&(e.__qclosepopup.depth=w(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});export{ae as C,te as a,ee as b,Y as c,ie as d,oe as e,ne as f,W as g,d as p,se as r,Z as u};
